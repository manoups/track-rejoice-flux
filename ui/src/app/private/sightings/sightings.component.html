<div class="listing-layout">
  <aside class="sidebar">
    <h2 class="sidebar-title">Filters</h2>

    <div class="mb-3">
      <label for="term" class="form-label">Search</label>
      <input
        id="term"
        name="term"
        class="form-control"
        [(ngModel)]="term"
        placeholder="Type to search..." />
      <div class="form-text">Sent as query parameter to the listing endpoint.</div>
    </div>

    <div class="mb-3">
      <label class="form-label">Other filters (skeleton)</label>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="onlyMine" disabled />
        <label class="form-check-label" for="onlyMine">Only mine (placeholder)</label>
      </div>
    </div>

    <div class="d-grid gap-2">
      <a routerLink="/sightings/new" class="btn btn-primary">Create Sighting</a>
    </div>
  </aside>

  <section class="content">
    <h1 class="page-title">Sightings</h1>

    <!-- Fixed header table -->
    <div class="table-frame">
      <table class="table table-striped table-hover table-fixed">
        <colgroup>
          <col style="width: 25%;">
          <col style="width: 35%;">
          <col style="width: 25%;">
          <col style="width: 15%;">
        </colgroup>
        <thead>
        <tr>
          <th scope="col">ID</th>
          <th scope="col">Owner</th>
          <th scope="col">Remove after matching</th>
          <th scope="col">Action</th>
        </tr>
        </thead>
      </table>

      <!-- Scrollable body with virtual rows -->
      <cdk-virtual-scroll-viewport
        class="viewport"
        [itemSize]="44"
        (scrolledIndexChange)="onScrollIndexChange($event)">

        <table class="table table-striped table-hover table-fixed">
          <colgroup>
            <col style="width: 25%;">
            <col style="width: 35%;">
            <col style="width: 25%;">
            <col style="width: 15%;">
          </colgroup>

          <tbody>
          <tr *cdkVirtualFor="let sighting of sightings(); trackBy: trackBySightingId">
            <td>{{ sighting.sightingId }}</td>
            <td>{{ sighting.ownerId }}</td>
            <td>{{ sighting.removeAfterMatching }}</td>
            <td>
              <button class="btn btn-outline-danger btn-sm" (click)="deleteSighting(sighting)">
                Delete
              </button>
            </td>
          </tr>

            @if (sightings().length === 0) {
              <tr>
                <td colspan="4">No sightings yet.</td>
              </tr>
            }
          </tbody>
        </table>

      </cdk-virtual-scroll-viewport>
    </div>
  </section>
</div>
